# -*- coding: utf-8 -*-
"""Untitled0.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1i_sCAgWqOO-qoafXZlO9WSYDO0gezj93
"""

# Upstage Solarë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•œ ë„êµ¬(OpenAI ë¼ì´ë¸ŒëŸ¬ë¦¬)ë¥¼ ì„¤ì¹˜í•©ë‹ˆë‹¤.
!pip install openai

from openai import OpenAI

# 1. Upstage API í‚¤ ì„¤ì • (ë”°ì˜´í‘œ ì•ˆì— ë°œê¸‰ë°›ì€ í‚¤ë¥¼ ë¶™ì—¬ë„£ìœ¼ì„¸ìš”)
api_key = "up_1QNAMG6RO2a4itE2aLXO2dohmoaQb"

# 2. Solar ëª¨ë¸ê³¼ ì—°ê²°
client = OpenAI(
    api_key=api_key,
    base_url="https://api.upstage.ai/v1/solar"
)

# 3. [í•µì‹¬] Solarì—ê²Œ 'ì‹¤ë²„ í†¡' ì—­í• ì„ ë¶€ì—¬í•˜ëŠ” ì„¤ì • (System Prompt)
# ì´ ë¶€ë¶„ì´ ë°”ë¡œ 'AI Agent ì„œë¹„ìŠ¤ ê¸°íš'ì˜ í•µì‹¬ì…ë‹ˆë‹¤.
silver_talk_persona = """
ë‹¹ì‹ ì€ ë””ì§€í„¸ ê¸°ê¸° ì‚¬ìš©ì´ ë‚¯ì„  70ëŒ€ ì´ìƒ ì–´ë¥´ì‹ ë“¤ì„ ë•ëŠ” 'ì¹œì ˆí•œ ë””ì§€í„¸ ì•ˆë‚´ì›'ì…ë‹ˆë‹¤.
ë‹¤ìŒ ì›ì¹™ì„ ë°˜ë“œì‹œ ì§€ì¼œì„œ ë‹µë³€í•˜ì„¸ìš”:
1. ì „ë¬¸ ìš©ì–´(ì¸í„°í˜ì´ìŠ¤, UX, í´ë¦­ ë“±)ëŠ” ì ˆëŒ€ ì“°ì§€ ë§ê³ , 'í™”ë©´ ê·¸ë¦¼', 'ëˆ„ë¥´ëŠ” ë‹¨ì¶”'ì²˜ëŸ¼ ì‰¬ìš´ ìš°ë¦¬ë§ë¡œ í’€ì–´ì„œ ì„¤ëª…í•˜ì„¸ìš”.
2. ë§ˆì¹˜ ì†ì£¼ê°€ í• ë¨¸ë‹ˆì—ê²Œ ì„¤ëª…í•˜ë“¯ ë§¤ìš° ì˜ˆì˜ ë°”ë¥´ê³  ë‹¤ì •í•˜ê²Œ, ì²œì²œíˆ ì„¤ëª…í•˜ëŠ” ë§íˆ¬ë¥¼ ì“°ì„¸ìš”. (~í•˜ì…¨ì–´ìš”?, ~ì…ë‹ˆë‹¤)
3. í•œ ë²ˆì— ë„ˆë¬´ ë§ì€ ì •ë³´ë¥¼ ì£¼ì§€ ë§ê³ , ë‹¨ê³„ë³„ë¡œ í•˜ë‚˜ì”© ì•Œë ¤ì£¼ì„¸ìš”.
4. ë¹„ìœ ë¥¼ ì ê·¹ í™œìš©í•˜ì„¸ìš”. (ì˜ˆ: 'í‚¤ì˜¤ìŠ¤í¬'ëŠ” 'ì€í–‰ ATM ê¸°ê³„'ì™€ ë¹„ìŠ·í•˜ë‹¤ê³  ì„¤ëª…)
"""

# 4. ëŒ€í™” í•¨ìˆ˜ ë§Œë“¤ê¸°
def ask_silver_talk(user_question):
    response = client.chat.completions.create(
        model="solar-1-mini-chat", # Solar ëª¨ë¸ ì‚¬ìš©
        messages=[
            {"role": "system", "content": silver_talk_persona}, # ì—­í•  ì£¼ì…
            {"role": "user", "content": user_question} # ì‚¬ìš©ìì˜ ì§ˆë¬¸
        ]
    )
    return response.choices[0].message.content

# --- ì‹¤ì œ ì‹¤í–‰ í…ŒìŠ¤íŠ¸ ---
print("ğŸ‘µ [ì‹¤ë²„ í†¡] ì•ˆë…•í•˜ì„¸ìš”, ì–´ë¥´ì‹ ! ìŠ¤ë§ˆíŠ¸í°ì´ë‚˜ ê¸°ê³„ ì“°ì‹œë‹¤ê°€ ê¶ê¸ˆí•œ ê²Œ ìˆìœ¼ì‹ ê°€ìš”?")

while True:
    question = input("\nì§ˆë¬¸ ì…ë ¥ (ì¢…ë£Œí•˜ë ¤ë©´ 'ê·¸ë§Œ' ì…ë ¥): ")
    if question == "ê·¸ë§Œ":
        break

    print("\nğŸ¤– ì†”ë¼ì˜ ë‹µë³€ ìƒê° ì¤‘...")
    answer = ask_silver_talk(question)
    print(f"\n[ì‹¤ë²„ í†¡ì˜ ë‹µë³€]\n{answer}")
    print("-" * 50)

import requests
import json
import os # íŒŒì¼ í™•ì¸ìš© ë„êµ¬ ì¶”ê°€

# 1. API í‚¤ (ì—¬ê¸°ì— ë³¸ì¸ í‚¤ë¥¼ ë‹¤ì‹œ ë„£ì–´ì£¼ì„¸ìš”!)
api_key = "up_1QNAMG6RO2a4itE2aLXO2dohmoaQb"
url = "https://api.upstage.ai/v1/document-ai/layout-analysis"
headers = {"Authorization": f"Bearer {api_key}"}

# [ìˆ˜ì •ëœ ë¶€ë¶„] íŒŒì¼ ì´ë¦„ ì•ì— '/content/'ë¥¼ ë¶™ì—¬ì„œ 'ì „ì²´ ì£¼ì†Œ'ë¥¼ ì•Œë ¤ì¤ë‹ˆë‹¤.
filename = "/test_image1.jpg"

# 2. ì§„ì§œ íŒŒì¼ì´ ìˆëŠ”ì§€ ê²€ì‚¬í•˜ëŠ” ì½”ë“œ (ë””ë²„ê¹…ìš©)
if os.path.exists(filename):
    print(f"âœ… íŒŒì¼ì„ ì°¾ì•˜ìŠµë‹ˆë‹¤! ê²½ë¡œ: {filename}")
else:
    print(f"âŒ ì—¬ì „íˆ íŒŒì¼ì„ ëª» ì°¾ê³  ìˆìŠµë‹ˆë‹¤. í˜„ì¬ í´ë”ì— ìˆëŠ” íŒŒì¼ë“¤: {os.listdir('/content')}")

# 3. Upstage ëˆˆ(Document Parse)ìœ¼ë¡œ ì´ë¯¸ì§€ ë¶„ì„ ìš”ì²­
def parse_image(file_path):
    print("ğŸ‘€ ì´ë¯¸ì§€ë¥¼ ë¶„ì„í•˜ê³  ìˆìŠµë‹ˆë‹¤... (ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”)")
    try:
        with open(file_path, "rb") as f:
            response = requests.post(url, headers=headers, files={"document": f})

        if response.status_code == 200:
            print("âœ… ë¶„ì„ ì™„ë£Œ!")
            return response.json()
        else:
            print(f"âŒ ì˜¤ë¥˜ ë°œìƒ: {response.status_code}")
            print(response.text)
            return None
    except FileNotFoundError:
        print("âŒ íŒŒì¼ ì½ê¸° ì‹¤íŒ¨")
        return None

# --- ì‹¤í–‰ ---
# íŒŒì¼ì´ í™•ì¸ëœ ê²½ìš°ì—ë§Œ ì‹¤í–‰
if os.path.exists(filename):
    result = parse_image(filename)

    # ê²°ê³¼ ë§›ë³´ê¸°
    if result:
        print("\n[ë¶„ì„ ê²°ê³¼ ì¼ë¶€]")
        elements = result.get('elements', [])
        for i, element in enumerate(elements[:5]):
            print(f"{i+1}. ì°¾ì€ ê¸€ì: {element['text']}")
            print(f"   ìœ„ì¹˜(ì¢Œí‘œ): {element['bounding_box']}")

# 1. ë°©ê¸ˆ ì½ì–´ì˜¨ ë°ì´í„°(result)ë¥¼ ê¸€ìë¡œ ì‹¹ ê¸ì–´ëª¨ìœ¼ê¸°
# (ì»´í“¨í„° ì–¸ì–´ì¸ JSONì„ Solarê°€ ì½ì„ ìˆ˜ ìˆëŠ” ë¬¸ìì—´ë¡œ ë°”ê¿‰ë‹ˆë‹¤)
import json
raw_data = json.dumps(result, ensure_ascii=False)

# 2. Solarì—ê²Œ ëª…ë ¹í•  ë‚´ìš© (í”„ë¡¬í”„íŠ¸ ì—”ì§€ë‹ˆì–´ë§)
# ëŒ€í‘œë‹˜ì´ ì›í•˜ì‹œëŠ” 'í‘œ í˜•íƒœ'ì™€ 'ê°€ê²© í¬í•¨' ìš”êµ¬ì‚¬í•­ì„ ì—¬ê¸°ì— ì ìŠµë‹ˆë‹¤.
prompt_for_solar = """
ë„ˆëŠ” í‚¤ì˜¤ìŠ¤í¬ í™”ë©´ì„ ì½ì–´ì£¼ëŠ” ì¹œì ˆí•œ AI ë¹„ì„œì•¼.
ë‚´ê°€ í‚¤ì˜¤ìŠ¤í¬ í™”ë©´ì„ ë¶„ì„í•œ 'ì›ì‹œ ë°ì´í„°(JSON)'ë¥¼ ì¤„ í…Œë‹ˆê¹Œ,
ì´ê±¸ ì–´ë¥´ì‹ ë“¤ì´ ë³´ê¸° í¸í•˜ê²Œ 'ë©”ë‰´íŒ í‘œ' í˜•íƒœë¡œ ì •ë¦¬í•´ì¤˜.

[ë°˜ë“œì‹œ ì§€ì¼œì•¼ í•  ê·œì¹™]
1. ì¡ë‹¤í•œ ì‹œìŠ¤í…œ ë¬¸êµ¬(ê²°ì œí•˜ê¸°, ë‚¨ì€ì‹œê°„, EK-192 ë“±)ëŠ” ë‹¤ ë¹¼ë²„ë ¤.
2. ì˜¤ì§ 'ë©”ë‰´ ì´ë¦„'ê³¼ 'ê°€ê²©'ë§Œ ì°¾ì•„ë‚´.
3. ë©”ë‰´ë“¤ì„ **í•œ ì¤„ì— 4ê°œì”©** ë°°ì¹˜í•´ì„œ í‘œ(Table)ë¥¼ ë§Œë“¤ì–´ì¤˜. (3í–‰ 4ì—´ êµ¬ì¡°ì•¼)
4. ê°€ê²©ì´ ë–¨ì–´ì ¸ ìˆì–´ë„, ë©”ë‰´ ì´ë¦„ ì˜†ì— ê´„í˜¸()ë¡œ ë¬¶ì–´ì„œ ë³´ì—¬ì¤˜. ì˜ˆ: ë”¸ê¸°ë¼ë–¼ (3,700ì›)
5. ê°€ì¥ ìœ„ì—ëŠ” 'ëŒ€ë¶„ë¥˜: ì‹ ë©”ë‰´', 'ì¤‘ë¶„ë¥˜: ë”¸ê¸°ì‹œì¦Œ' ì´ë¼ê³  ì ì–´ì¤˜.
6. ì¶œë ¥ í˜•ì‹ì€ ê¹”ë”í•œ ë§ˆí¬ë‹¤ìš´ í‘œ(Markdown Table)ì—¬ì•¼ í•´.
"""

# 3. Solarì—ê²Œ ì •ë¦¬ ìš”ì²­í•˜ê¸°
print("ğŸ§  Solarê°€ ë©”ë‰´íŒì„ ì •ë¦¬í•˜ê³  ìˆìŠµë‹ˆë‹¤... (ë‘ë‡Œ í’€ê°€ë™!)")

response = client.chat.completions.create(
    model="solar-1-mini-chat",
    messages=[
        {"role": "system", "content": prompt_for_solar},
        {"role": "user", "content": f"ì´ ë°ì´í„° ì¢€ ì •ë¦¬í•´ì¤˜:\n{raw_data}"}
    ]
)

# 4. ê²°ê³¼ ì¶œë ¥
final_output = response.choices[0].message.content
print("\n" + "="*50)
print("     [ğŸ“ ì–´ë¥´ì‹ ì„ ìœ„í•œ ë³´ê¸° í¸í•œ ë©”ë‰´íŒ ğŸ“]")
print("="*50 + "\n")
print(final_output)

import requests
import json
import os
from openai import OpenAI

# ======================================================
# [1] ì„¤ì • êµ¬ì—­ (ì—¬ê¸°ë§Œ ìˆ˜ì •í•˜ì„¸ìš”!)
# ======================================================
api_key = "up_1QNAMG6RO2a4itE2aLXO2dohmoaQb"  # API í‚¤ í•„ìˆ˜!
filename = "/test_image1.jpg"       # ë¶„ì„í•  íŒŒì¼ ì´ë¦„ (ì•ì— / ê¼­ ë¶™ì´ê¸°)
# ======================================================

# ì¤€ë¹„: Upstage ì—°ê²° ì„¤ì •
layout_url = "https://api.upstage.ai/v1/document-ai/layout-analysis"
headers = {"Authorization": f"Bearer {api_key}"}
client = OpenAI(api_key=api_key, base_url="https://api.upstage.ai/v1/solar")

def analyze_and_format():
    # 1ë‹¨ê³„: íŒŒì¼ì´ ì§„ì§œ ìˆëŠ”ì§€ í™•ì¸
    if not os.path.exists(filename):
        print(f"âŒ ì˜¤ë¥˜: '{filename}' íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")
        print(f"ğŸ‘‰ í˜„ì¬ í´ë”ì— ìˆëŠ” íŒŒì¼ë“¤: {os.listdir('/')}")
        return

    # 2ë‹¨ê³„: ì´ë¯¸ì§€ ë¶„ì„ (Document Parse - ëˆˆ)
    print(f"ğŸ‘€ '{filename}' ì´ë¯¸ì§€ë¥¼ ë¶„ì„ ì¤‘ì…ë‹ˆë‹¤... (1/2)")
    with open(filename, "rb") as f:
        response = requests.post(layout_url, headers=headers, files={"document": f})

    if response.status_code != 200:
        print("âŒ ì´ë¯¸ì§€ ë¶„ì„ ì‹¤íŒ¨!")
        print(response.text)
        return

    result = response.json() # ê²°ê³¼ë¥¼ result ë³€ìˆ˜ì— í™•ì‹¤í•˜ê²Œ ì €ì¥!
    print("âœ… ì´ë¯¸ì§€ ë¶„ì„ ì™„ë£Œ! ì´ì œ Solarê°€ ì •ë¦¬ë¥¼ ì‹œì‘í•©ë‹ˆë‹¤... (2/2)")

    # 3ë‹¨ê³„: Solarì—ê²Œ ì •ë¦¬ ì‹œí‚¤ê¸° (Solar - ë‡Œ)
    raw_data = json.dumps(result, ensure_ascii=False)

    prompt = """
    ë„ˆëŠ” í‚¤ì˜¤ìŠ¤í¬ í™”ë©´ì„ ì½ì–´ì£¼ëŠ” ì¹œì ˆí•œ AI ë¹„ì„œì•¼.
    ì œê³µëœ JSON ë°ì´í„°ë¥¼ ë°”íƒ•ìœ¼ë¡œ ë©”ë‰´íŒì„ ì •ë¦¬í•´ì¤˜.

    [ê·œì¹™]
    1. ì¡ë‹¤í•œ ì‹œìŠ¤í…œ ë¬¸êµ¬ëŠ” ì œì™¸í•˜ê³  'ë©”ë‰´ëª…'ê³¼ 'ê°€ê²©'ë§Œ ì¶”ì¶œí•´.
    2. ë©”ë‰´ë¥¼ í•œ ì¤„ì— 3~4ê°œì”© ë°°ì¹˜í•´ì„œ ë³´ê¸° ì¢‹ì€ 'ë§ˆí¬ë‹¤ìš´ í‘œ'ë¡œ ë§Œë“¤ì–´.
    3. ê°€ê²©ì€ ë©”ë‰´ëª… ì˜†ì— ê´„í˜¸()ë¡œ ë„£ì–´ì¤˜.
    4. ìƒë‹¨ì— ì¹´í…Œê³ ë¦¬(ëŒ€ë¶„ë¥˜/ì¤‘ë¶„ë¥˜)ê°€ ìˆë‹¤ë©´ ì ì–´ì¤˜.
    """

    response = client.chat.completions.create(
        model="solar-1-mini-chat",
        messages=[
            {"role": "system", "content": prompt},
            {"role": "user", "content": f"ë°ì´í„°: {raw_data}"}
        ]
    )

    # 4ë‹¨ê³„: ìµœì¢… ê²°ê³¼ ì¶œë ¥
    print("\n" + "="*50)
    print(f"     [ğŸ“ {filename} ë¶„ì„ ê²°ê³¼ ğŸ“]")
    print("="*50 + "\n")
    print(response.choices[0].message.content)

# --- ì‹¤í–‰ ---
analyze_and_format()

# [ê³¼ì œ 1] Upstage AI Ambassador ì§€ì›ì ì œì¶œ ì½”ë“œ
# ì£¼ì œ : ë…¸ë…„ì¸µì„ ìœ„í•œ ì‹¤ì‹œê°„ í‚¤ì˜¤ìŠ¤í¬ ì£¼ë¬¸ ë„ìš°ë¯¸
# ì‘ì„±ì : ì£¼ì˜ì§„

import requests
import json
import os
import textwrap
from openai import OpenAI

# ====================================================================
# [ì‚¬ìš© ê°€ì´ë“œ]
# 1. Upstage Consoleì—ì„œ ë°œê¸‰ë°›ì€ API Keyë¥¼ ì•„ë˜ ë³€ìˆ˜ì— ì…ë ¥í•´ì£¼ì„¸ìš”.
# 2. ë¶„ì„í•  ì´ë¯¸ì§€ íŒŒì¼(ì˜ˆ: kiosk.jpg)ì„ ê°™ì€ í´ë”ì— ì—…ë¡œë“œí•´ì£¼ì„¸ìš”.
# ====================================================================

# 1. API í‚¤ ì„¤ì •
api_key = "YOUR_UPSTAGE_API_KEY_HERE"

# 2. ë¶„ì„í•  ì´ë¯¸ì§€ íŒŒì¼ëª… ì„¤ì •
filename = "/content/test_image1.jpg" # Colab í™˜ê²½ ê¸°ì¤€ ê²½ë¡œ

# 3. í…ìŠ¤íŠ¸ ì¤„ë°”ê¿ˆ ë„ˆë¹„ ì„¤ì • (ì›í•˜ëŠ” í¬ê¸°ë§Œí¼ ì„¤ì •)
USER_WIDTH = 40
AI_WIDTH = 60

# ===================================================================

client = OpenAI(api_key=api_key, base_url="https://api.upstage.ai/v1/solar")
layout_url = "https://api.upstage.ai/v1/document-ai/layout-analysis"
headers = {"Authorization": f"Bearer {api_key}"}

silver_persona = """
ë‹¹ì‹ ì€ í‚¤ì˜¤ìŠ¤í¬ ì‚¬ìš©ì´ ì–´ë ¤ìš´ ì–´ë¥´ì‹ ì„ ë•ëŠ” 'ì‹¤ë²„ í†¡' ë¹„ì„œì…ë‹ˆë‹¤.
ë‹¤ìŒ ì›ì¹™ì„ ì§€ì¼œì£¼ì„¸ìš”:
1. ì†ì£¼ì²˜ëŸ¼ ì˜ˆì˜ ë°”ë¥´ê³  ë‹¤ì •í•˜ê²Œ ë§ì”€í•˜ì„¸ìš”. (~í•˜ì„¸ìš”, ~ì…ë‹ˆë‹¤)
2. ì–´ë ¤ìš´ ì™¸ë˜ì–´ëŠ” ì‰½ê²Œ í’€ì–´ì„œ ì„¤ëª…í•˜ê³ , ë©”ë‰´ì˜ ìœ„ì¹˜ë‚˜ ê°€ê²©ì„ ì •í™•íˆ ì•ˆë‚´í•˜ì„¸ìš”.
3. ë‹µë³€ì´ ë„ˆë¬´ ê¸¸ì–´ì§€ì§€ ì•Šê²Œ í•µì‹¬ë§Œ ê°„ë‹¨íˆ ë§í•´ì£¼ì„¸ìš”.
"""

def silver_talk_start():
    print(f"ğŸš€ [ì‹¤ë²„ í†¡] ì‹œìŠ¤í…œì„ ì‹œì‘í•©ë‹ˆë‹¤...")

    # Step 1 : ì´ë¯¸ì§€ ë¶„ì„ (Document Parse)
    if not os.path.exists(filename):
        print(f"âš ï¸ ê²½ê³ : '{filename}' íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. í…ŒìŠ¤íŠ¸í•  ì´ë¯¸ì§€ë¥¼ ì—…ë¡œë“œí•´ì£¼ì„¸ìš”.")
        return

    print(f"ğŸ‘€ ì´ë¯¸ì§€ë¥¼ ë¶„ì„í•˜ê³  ìˆìŠµë‹ˆë‹¤... (Document Parse API)")
    try:
        with open(filename, "rb") as f:
            response = requests.post(layout_url, headers=headers, files={"document": f})

        if response.status_code != 200:
            print(f"âŒ ë¶„ì„ ì‹¤íŒ¨: API Keyë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”. (í˜„ì¬ ì„¤ì •: {api_key[:5]}...)")
            return

        scan_result = json.dumps(response.json(), ensure_ascii=False)
        print("âœ… ì´ë¯¸ì§€ ë¶„ì„ ì™„ë£Œ! Solarê°€ ë‚´ìš©ì„ ì´í•´í•˜ê³  ìˆìŠµë‹ˆë‹¤...\n")
    except Exception as e:
        print(f"âŒ ì˜¤ë¥˜ ë°œìƒ: {e}")
        return

    # Step 2 : ìš”ì•½ ë° ì •ë¦¬ (Solar LLM)
        summary_prompt = """
    ì œê³µëœ JSON ë°ì´í„°ë¥¼ ë°”íƒ•ìœ¼ë¡œ:
    1. [ì¹œì ˆí•œ ìš”ì•½]: ì „ì²´ ë©”ë‰´ ì¢…ë¥˜ì™€ ê°€ì¥ ì €ë ´í•œ ë©”ë‰´ë¥¼ 3ì¤„ ë‚´ë¡œ ìš”ì•½í•´.
    2. [ë©”ë‰´íŒ ì •ë¦¬]: ë©”ë‰´ëª…ê³¼ ê°€ê²©ì„ ë§ˆí¬ë‹¤ìš´ í‘œë¡œ ê¹”ë”í•˜ê²Œ ì •ë¦¬í•´.
    """

    try:
        summary_response = client.chat.completions.create(
            model="solar-1-mini-chat",
            messages=[
                {"role": "system", "content": silver_persona},
                {"role": "user", "content": f"ë°ì´í„°: {scan_result}\n\n{summary_prompt}"}
            ]
        )
        menu_context = summary_response.choices[0].message.content

        print("="*60)
        print(f"ğŸ¤– [ì‹¤ë²„ í†¡]: ì–´ë¥´ì‹ , ì‚¬ì§„ì„ ë³´ë‹ˆ ì´ëŸ° ë©”ë‰´ë“¤ì´ ìˆë„¤ìš”!\n")
        print(menu_context)
        print("="*60)
    except Exception as e:
        print(f"âŒ Solar ì—°ê²° ì‹¤íŒ¨: {e}")
        return

    # Step 3 : ëŒ€í™” ì‹œì‘ (Interaction)
    print("\nğŸ¤ ê¶ê¸ˆí•œ ê²Œ ìˆìœ¼ì‹œë©´ ë¬¼ì–´ë³´ì„¸ìš”! (ì¢…ë£Œí•˜ë ¤ë©´ 'ê·¸ë§Œ' ì…ë ¥)")

    chat_history = [
        {"role": "system", "content": silver_persona},
        {"role": "system", "content": f"ë©”ë‰´ ì •ë³´:\n{scan_result}"},
        {"role": "assistant", "content": menu_context}
    ]

    while True:
        try:
            user_input = input("\nğŸ“ ì§ˆë¬¸ ì…ë ¥: ")
            if user_input.strip() == "ê·¸ë§Œ":
                print("ğŸ¤– [ì‹¤ë²„ í†¡]: ë„¤, ì¡°ì‹¬íˆ ë“¤ì–´ê°€ì„¸ìš”!")
                break

            print("\nğŸ‘µ [ì–´ë¥´ì‹ ]:")
            print(textwrap.fill(user_input, width=USER_WIDTH))

            chat_history.append({"role": "user", "content": user_input})

            answer_response = client.chat.completions.create(
                model="solar-1-mini-chat",
                messages=chat_history
            )

            ai_answer = answer_response.choices[0].message.content

            print("\nğŸ¤– [ì‹¤ë²„ í†¡]:")
            print(textwrap.fill(ai_answer, width=AI_WIDTH))
            print("-" * AI_WIDTH)

            chat_history.append({"role": "assistant", "content": ai_answer})

        except KeyboardInterrupt:
            print("\nì¢…ë£Œí•©ë‹ˆë‹¤.")
            break

# ì‹¤í–‰ (API Keyê°€ ì„¤ì •ë˜ì–´ì•¼ ì‘ë™í•©ë‹ˆë‹¤)
if __name__ == "__main__":
    if api_key == "YOUR_UPSTAGE_API_KEY_HERE":
        print("âš ï¸ [ì•Œë¦¼] ìŠ¤í¬ë¦½íŠ¸ ìƒë‹¨ì˜ 'api_key' ë³€ìˆ˜ì— ë³¸ì¸ì˜ API Keyë¥¼ ì…ë ¥ í›„ ì‹¤í–‰í•´ì£¼ì„¸ìš”.")
    else:
        silver_talk_start()